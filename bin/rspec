#!/usr/bin/env ruby
require 'shellwords'

if !ENV['RAILS_LOCAL'] && system("which docker-compose > /dev/null 2>&1")
  exec "docker-compose exec $(docker-compose ps --services --filter 'status=running' | grep web) sh -c 'ITERATIONS=#{ENV['ITERATIONS']} bin/rspec #{Shellwords.join(ARGV)}'"
else
  require 'bundler/setup'
  load Gem.bin_path('rspec-core', 'rspec')
end
